
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/000/iconfont.css">
    <link rel="stylesheet" href="../css/000/public.css">
    <link rel="stylesheet" href="../css/000/like.css">
    <link rel="stylesheet" href="../css/购物车/购物车.css">
    <style>
        table{
            overflow: hidden;
            border: none;
        }
        tbody img{
            width: 100px;
            height: 100px;
        }
        thead{
            font-size: 16px;
            text-align: center;
        }
        thead th{
            width: 180px;
            line-height: 26px;
            font-size: 14px;
        }
        tbody{
            text-align: center;
        }
        tbody td:nth-child(6) p{
            width: 73px;
            height: 40px;
            background-color: red;
            line-height: 40px;
            text-align: center;
            display: inline-block;
        }
        tbody .number{
            width: 33px;
        }
    </style>
</head>
<body>
    <div id="hint">
        <div class="content">
            <p>温馨提示: 受疫情影响，目前暂停发往新疆快件，在途包裹将在恢复后进行配送，不便之处敬请谅解 ！</p>
        </div>
    </div>
    <div id="header_top">
        <div class="content">
            <div class="header_top_left">
                <a href="#">
                    <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/flag.png" alt="">
                    <span>English Site</span>
                </a>
                <span> | </span>
                <span>客服咨询</span>
            </div>
            <div class="header_top_right">
                <a href="./登录.html">登录</a>
                <a href="./注册.html">注册</a>
                <span>|</span>
                <a href="#">我的订单</a>
                <a href="#">个人中心</a>
                <a href="#">我的收藏夹<i class="iconfont icon-xinaixin"></i></a>
                <a href="#" class="header_top_right_a6">关注我们<i class="iconfont icon-sanx-up"></i></a>
                <a href="#">帮助</a>
                <a href="#">消费者告知书</a>
            </div>
        </div>
    </div>
    <div id="header_bottom">
        <div class="content">
            <div class="arrange0">
                <a href="./首页.html">
                    <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/logo/logo.png" alt="" >
                </a>
            </div>
            <div class="arrange1">
                <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/slogan-new.png" alt="">
            </div>
            <div class="arrange2">
                <div class="search">
                    <form action="">
                        <i class="iconfont icon-fangdajing"></i>
                        <input type="text" placeholder="Eaoron"><button>搜 索</button>
                    </form>
                </div>
                <p>
                    <span>热门搜索</span>
                    <a href="#">A2</a>
                    <a href="#">面膜</a>
                    <a href="#">Unichi</a>
                    <a href="#">bio island</a>
                    <a href="#">cemoy</a>
                </p>
            </div>
            <div class="arrange3">
                <button>
                    <a href="../html/购物车.html">
                        <i class="iconfont icon-qicheqianlian-select"></i>
                        <i>我的购物车</i>
                    </a>
                </button>
            </div>
        </div>
    </div>
    <div id="nav">
        <div class="content">
            <a href="#">必入尖货</a>
            <a href="#">新品上线</a>
            <a href="#">营养保健</a>
            <a href="#">母婴产品</a>
            <a href="#">美妆个护</a>
            <a href="#">洗护日用</a>
            <a href="#">家庭常备</a>
            <a href="#">健康辅助</a>
            <a href="#">食品饮料</a>
            <a href="#">宠物护理</a>
            <a href="#">品牌A-Z</a>
        </div>
    </div>
    <div class="content">
        <table>
            <thead>
                <tr>
                    <th>图片</th>
                    <th>名字</th>
                    <th>单价</th>
                    <th>数量</th>
                    <th>总价</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
            </tbody>	
            </table>
    
    </div>
    <div id="footer">
        <div class="synopsis">
            <div class="content">
                <div class="synopsis_left">
                    <h2>Pharmacy Online简介</h2>
                    <p>Pharmacy Online是澳洲药品保健品和营养品类电商之一， 总部位于澳大利亚新南威尔土州。1998年， Pharmacy Online以40年的处方药和医药企业经营经验，成立了网上药房后，并迅速发展成为澳大利亚受欢迎的在线药房之一。</p>
                    <p>2015年，Pharmacy Online开直邮中国业务，提供众多澳洲热销奶粉辅食，母婴用品，肌肤护理，营养保健品，家居用品等等，支持支付宝和银联支付，包裹全程可追踪，中文客服咨询服务，一站式购物带给你完美的澳淘体验!</p>    
                </div>
                <div class="synopsis_right">
                    <div>
                        <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/logo/wxcode.png" alt="">
                        <p>加微信，得优惠</p>
                    </div>
                    <div>
                        <img src="https://img-resource.azoyacdn.com/media/04b9401070a729593631ef634afe5991/8973/eae90ed1262859875da7264ef63bce30.png" alt="">
                        <p>扫码下载APP</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="base_top">
            <div class="content">
                <div class="base_top_left">
                    <ul>
                        <li>
                            <p>关于我们</p>
                            <a href="">商户介绍</a>
                            <a href="">正品承诺</a>
                            <a href="">联系我们</a>
                        </li>
                        <li>
                            <p>物流配送</p>
                            <a href="">配送方式</a>
                            <a href="">运费标准</a>
                            <a href="">物流跟踪</a>
                        </li>
                        <li>
                            <p>售后政策</p>
                            <a href="">退货退款政策</a>
                            <a href="">退货退款流程</a>
                            <a href="">联系客服</a>
                        </li>
                        <li>
                            <p>网站政策</p>
                            <a href="">服务条款</a>
                            <a href="">隐私权保护政策</a>
                            <a href="">消费者告知书</a>
                        </li>
                        <li>
                            <p>消费者指南</p>
                            <a href="">购物流程</a>
                            <a href="">常见问题</a>
                            <a href="">关税发票</a>
                        </li>
                    </ul>
                </div>
                <div class="base_top_right">
                    <p>
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAASCAMAAACO0hVbAAAAdVBMVEUAAAAdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7htc98ZAAAAJnRSTlMA7wkZjCb69ElAMRUQzcrBv29f59/Fn5V9dGZUNiwe1dDCuK+BWRCKzIQAAACfSURBVBjTXc5XDoMwEEXRcQMXeugtffa/xNhgCHB/RjrSkwb2KJyj/TNO46w4kEhaYw/jFduIPTTtqjLNqYojb2/J7uhKom+9kiLwwrUaAr0sQyJwyyBxa4lk2E0hjtZMSORuI96WPzWPAk+ENgJ8H285HOJOgvYPOhtAdDyfocimlWSAmBbCTH2CGCpHc4jHCLPW4Dlu7XaxEoDiNfgBRNQYVsEJrCAAAAAASUVORK5CYII=" alt="">
                        <a href="#">在线客服</a>
                    </p>
                    <p>
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAMAAAAhxq8pAAAAYFBMVEUdb7gdb7gdb7gAAAAdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7iK75bUAAAAH3RSTlOQMA8AalvQeKU/++GHN/Ls07+fdEwU9tTHr5V6KSQeRbEGSgAAAHtJREFUGNNlzlkOwyAMRdFXDE3NkDmdW+9/l4WIfuDcL3SEZYPoe2rbCATRWZA/4AjqtPkVxmp1C4wodZdzxqyNScFGs1Wctr+6d6j44MF29d+YbjvO61XELl76MhvSPWN0+/nPxDyVx8ARZEXVM4y2sojCAWfQJ6LtZX7wPBsN/TA65gAAAABJRU5ErkJggg==" alt="">
                        <span>联系客服:china@pharmacyonline.com.au</span>
                    </p>
                    <p>
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAATCAMAAACqTK3AAAAAUVBMVEUAAAAdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7gdb7joJogaAAAAGnRSTlMAUPjBaeCwhlowDgfQQfDm2b24nIWAdx3UyWdOyZwAAACASURBVBjTXcpZAsIgDEXRV0qZ6Two+1+oQESE+xM4CSjjlfIGNS1YiDGhi8jwS5Ic+XNdeRxJOO2HgSYHzNzSbOiIqJztPe2YeprACnnnXNozLIWQirZg/NJrjL3jY8Qdum48rBX2AGdLJwC7/ctmkUxUERaUWglWhZrmUnKN3Ad+SBZ35HXG0wAAAABJRU5ErkJggg==" alt="">
                        <span>中文客服的工作时间为周一至周五9:00- 18:00(北京时间)</span>
                    </p>
                </div>
    
            </div>
        </div>
        <div class="base_middle">
            <div class="content">
                <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/bottom/code_13.png" alt="">
                <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/bottom/code_15.png" alt="">
                <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/bottom/code_weixin.png" alt="">
                <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/bottom/code_17.png" alt="">
                <img src="https://po-assets.azoyacdn.com/skin/frontend/PlumTree/po_pc_v2/images/bottom/code_19.png" alt="">    
            </div>
        </div>
        <div class="base_bottom">
            <div class="content">
                <p>All prices are in Australian Dollars.</p>
                <span></span>
            </div>
        </div>
    </div>

</body>
	<script type="text/javascript">
		
		class Car{
//			1.构造函数
			constructor(){
				this.tBody = document.querySelector("tbody");
			}
//			2.从本地存储中拿到数据,准备在购物车页面显示
            getData(){
//          	2.1 立即拿到数据
                if(localStorage.getItem("goodsMsg")){
//              	2.2把其变为json对象格式,方便于调用其中的属性
                	this.gm = JSON.parse(localStorage.getItem("goodsMsg"));
                }
                else{
                	this.gm = [];
                }
                //3.准备渲染页面
                this.display();
            }
            display(){
//          	3.1 准备一个空字符串
            	var str = "";
//          	3.2把数据填入字符串中,准备放到页面上
            	for(var i=0;i<this.gm.length;i++){
                str += `<tr index="${this.gm[i].goodsId}">
                            <td><img src="${this.gm[i].msg.img}" alt=""></td>
                            <td>${this.gm[i].msg.name}</td>
                            <td>${this.gm[i].msg.price}</td>
                            <td><input type="number" min="1" value="${this.gm[i].num}" class="number"></td>
                            <td>${ this.gm[i].msg.price * this.gm[i].num }</td>
                            <td class="delete"><p>删除</p></td>
                        </tr>`;
            }
//          	3.3渲染	
                this.tBody.innerHTML = str;
            }
//             事件绑定
            addEvent(){
               	var that = this;
//             4.删除功能
//             4.1因为我们一开始在html中并没有删除,所以需要用到事件委托
                this.tBody.onclick = function(eve){
                	var e = eve || window.event;
                	var tar = e.target || e.srcElement;
                	if(tar.className == "delete" ){
                		// 4.2先获取当前点击删除按钮的商品的id
                		that.id = tar.parentNode.getAttribute("index");
//              		4.3删除对应DOM元素
                        tar.parentNode.remove();
//                      4.5删除对应存储在本地的数据
                        that.changeData(function(i){
                        	 that.gm.splice(i,1);
                        });
                	
                    }
                }
//              5.总价跟着数量而改变
//              5.1首先也是通过事件委托拿到数量
                this.tBody.oninput = function(eve){
                	var e = eve || window.event;
                    var tar = e.target || e.srcElement;
                    if(tar.className === "number"){
                      //5.2.获取要修改数量的商品的id
                    that.id = tar.parentNode.parentNode.getAttribute("index");
                      // 5.3.执行修改本地存储中数据的功能
                    that.changeData(function(i){
                        that.gm[i].num = tar.value;
                    });
//                  5.4每次修改数量时,来计算总价
                    tar.parentNode.nextElementSibling.innerHTML = tar.value * tar.parentNode.previousElementSibling.innerHTML;
                    }
		        }
            }
  //          4.4通过点击获取的商品的id来找到本地存储中对应商品
            changeData(cb){
            // 根据点击的商品的id查找本地存储的数据中符合的商品数据
                for(var i=0;i<this.gm.length;i++){
                if(this.gm[i].goodsId === this.id){
                    cb(i);
                    break;
                }
                }
               // 剔除掉之后，得再存回去，否则仅仅是在内存中修改，没有修改本地存储
              localStorage.setItem("goodsMsg",JSON.stringify(this.gm));
            }
		
		
		}
//		4.先创建实例对象进行页面查看
		var c = new Car();
		c.getData();
		c.addEvent();
		
	</script>

</body>
</html>